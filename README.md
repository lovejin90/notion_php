# Notion PHP Wiki

## 개요
이 프로젝트는 Notion API를 사용하여 Notion 데이터베이스와 페이지를 HTML로 변환하여 표시하는 PHP 기반 위키 시스템입니다. 사용자는 Notion에 저장된 문서를 웹 페이지 형태로 쉽게 탐색하고 볼 수 있습니다.

## 주요 기능

### 1. Notion 데이터베이스 탐색
- 등록된 모든 Notion 데이터베이스 목록 표시
- 각 데이터베이스의 최종 수정 시간 및 포함된 페이지 수 표시

### 2. 페이지 목록 조회
- 데이터베이스 내 페이지를 카테고리별로 그룹화하여 표시
- 페이지의 커버 이미지, 아이콘, 제목, 카테고리 태그, 상태, 날짜 정보 제공
- 카테고리별로 최대 4개의 페이지 미리보기 지원

### 3. 페이지 내용 표시
- Notion 페이지의 다양한 블록 타입을 HTML로 변환하여 표시
  - 텍스트(제목, 단락, 인용문 등)
  - 목록(번호 목록, 글머리 기호 목록)
  - 코드 블록 (구문 강조 지원)
  - 이미지
  - 체크박스
  - 토글 목록
  - 콜아웃 블록
  - 구분선 등
- 텍스트 서식(굵게, 기울임, 취소선, 밑줄, 코드) 지원
- 링크 지원

### 4. 사용자 인터페이스
- 반응형 디자인으로 모바일 및 데스크탑 지원
- 사이드바 메뉴로 쉬운 데이터베이스 탐색
- 뒤로가기 기능
- 코드 블록에 highlight.js를 사용한 구문 강조

## 기술 스택
- PHP 7+
- cURL (Notion API 연동)
- HTML/CSS/JavaScript
- highlight.js (코드 구문 강조)
- Font Awesome (아이콘)

## 설치 방법

1. 코드를 웹 서버에 업로드합니다.
2. Notion API 키를 발급받습니다.
   - [Notion 개발자 페이지](https://developers.notion.com/)에서 새 통합을 생성
   - 필요한 권한 부여 (데이터베이스 및 페이지 읽기)
3. `$notionApiKey` 변수에 발급받은 API 키를 설정합니다.
4. 웹 브라우저에서 설치된 URL로 접속합니다.

## 사용 방법

### 데이터베이스 목록 조회
- 루트 URL(`/notion`)에 접속하면 모든 데이터베이스 목록이 표시됩니다.

### 특정 데이터베이스의 페이지 조회
- 데이터베이스 카드나 사이드바 메뉴에서 데이터베이스를 클릭하면 해당 데이터베이스의 페이지 목록이 표시됩니다.
- URL 형식: `/notion?db=데이터베이스ID`

### 페이지 내용 조회
- 페이지 카드를 클릭하면 해당 페이지의 내용이 표시됩니다.
- URL 형식: `/notion?page_id=페이지ID`

### 카테고리별 페이지 필터링
- 카테고리를 기준으로 페이지를 필터링할 수 있습니다.
- URL 형식: `/notion?db=데이터베이스ID&category=카테고리명`

## 주요 함수 설명

### API 관련 함수
- `getNotionDatabases()`: Notion 데이터베이스 목록 조회
- `getDatabasePages($databaseId)`: 특정 데이터베이스의 페이지 목록 조회
- `getNotionPageAsHtml($pageId)`: 페이지 내용을 HTML로 변환

### 렌더링 함수
- `renderBlock($block)`: Notion 블록을 HTML로 변환
- `renderRichText($text)`: 서식이 있는 텍스트를 HTML로 변환
- `extractPageInfo($pages)`: 페이지 정보 추출 및 가공

### UI 관련 함수
- `outputHeader($title)`: 페이지 헤더 출력
- `outputSidebar($databases)`: 사이드바 메뉴 출력
- `outputFooter()`: 페이지 푸터 출력
- `getList($pagesList)`: 페이지 목록 UI 생성 및 출력

## 주의 사항
- Notion API 키는 보안을 위해 공개되지 않도록 주의해야 합니다.
- 대용량 데이터베이스의 경우 성능 이슈가 발생할 수 있습니다.
- 현재 모든 블록 타입을 지원하지는 않습니다.
- 토글 블록의 내부 내용은 추가 API 호출이 필요합니다 (현재 버전에서는 미지원).

## 커스터마이징
- `assets/style.css` 파일을 수정하여 디자인을 변경할 수 있습니다.
- `renderBlock()` 함수를 확장하여 추가 블록 타입을 지원할 수 있습니다.
- 필터링 기능을 확장하여 더 다양한 필터 옵션을 제공할 수 있습니다.